<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="modulepreload" href="FIRM_dsl/resonance.js?v=2025-10-04-1" />
    <script src="physics_constants.js?v=2025-10-06-e8"></script>
    <script src="e8_visualizer.js?v=2025-10-06-e8"></script>
    <script type="module" src="e8_webgl_integration.js?v=2025-10-06"></script>
    <script src="mass_spectrum_display.js?v=2025-10-06"></script>
    <title>FIRM UI - E8 Universe Simulation</title>
    <style>
      :root {
        --top-bar-height: 64px;
        --metrics-height: 0px;
      }

      body {
        margin: 0;
        font-family: system-ui, sans-serif;
        background: #0b0b0b;
        color: #eaeaea;
        min-height: 100vh;
        padding-top: var(--top-bar-height);
        overflow: hidden;
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
      }

      #topBar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 60;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 12px;
        padding: 12px 18px;
        background: rgba(11, 11, 11, 0.95);
        backdrop-filter: blur(8px);
        border-bottom: 1px solid #1f1f1f;
        box-sizing: border-box;
      }

      #topBar .brand {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      #topBar .brand strong {
        font-size: 16px;
        letter-spacing: 0.06em;
      }

      #topBar .brand span {
        font-size: 12px;
        color: #9aa7c3;
      }

      #topBar .top-actions {
        margin-left: auto;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 8px;
      }

      #viewSelector {
        background: #151515;
        color: #eaeaea;
        border: 1px solid #2a2a2a;
        border-radius: 6px;
        padding: 6px 10px;
        font-size: 13px;
      }

      .top-btn {
        padding: 6px 10px;
        border-radius: 6px;
        border: 1px solid #2a2a2a;
        background: #151515;
        color: #eaeaea;
        cursor: pointer;
        transition: background 0.2s, border-color 0.2s;
        font-size: 13px;
      }

      .top-btn:hover {
        background: #1f1f1f;
        border-color: #3b3b3b;
      }

      .interpretation-btn {
        background: #2a4a6a;
        border-color: #2a4a6a;
      }

      .interpretation-btn:hover {
        background: #355f89;
        border-color: #355f89;
      }

      .metrics-panel {
        position: fixed;
        top: var(--top-bar-height);
        left: 0;
        right: 0;
        z-index: 50;
        background: rgba(15, 15, 15, 0.92);
        border-bottom: 1px solid #252525;
        backdrop-filter: blur(8px);
        box-sizing: border-box;
      }

      .metrics-panel.collapsed .metrics-content {
        display: none;
      }

      .metrics-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 16px;
        cursor: pointer;
      }

      .metrics-title {
        font-size: 13px;
        font-weight: 600;
        color: #4a9eff;
      }

      .metrics-content {
        padding: 12px 16px 16px;
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 16px;
      }

      .metric-group {
        background: #161616;
        padding: 12px;
        border-radius: 6px;
        border: 1px solid #232323;
      }

      .metric-group h4 {
        margin: 0 0 8px;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #4a9eff;
      }

      .metric-row {
        display: flex;
        justify-content: space-between;
        font-size: 11px;
        margin: 4px 0;
      }

      .metric-label {
        color: #a0a0a0;
      }

      .metric-row span:last-child {
        color: #f2f2f2;
        font-weight: 600;
        font-family: "Courier New", monospace;
      }

      #canvasContainer {
        position: fixed;
        top: calc(var(--top-bar-height) + var(--metrics-height));
        left: 0;
        right: 0;
        bottom: 0;
      }

      #canvas {
        width: 100%;
        height: 100%;
        display: block;
      }

      #controlPanel {
        position: fixed;
        top: calc(var(--top-bar-height) + var(--metrics-height) + 16px);
        right: 16px;
        z-index: 55;
        width: 340px;
        max-height: calc(100vh - (var(--top-bar-height) + var(--metrics-height) + 32px));
        padding: 18px 18px 52px;
        background: rgba(0, 0, 0, 0.9);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 18px 36px rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(12px);
        overflow-y: auto;
        transform: translateX(calc(100% + 24px));
        opacity: 0;
        pointer-events: none;
        transition: transform 0.28s ease, opacity 0.28s ease;
      }

      body.controls-open #controlPanel {
        transform: translateX(0);
        opacity: 1;
        pointer-events: auto;
      }

      #controlPanel h3 {
        margin: 16px 0 8px;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #9aa7c3;
      }

      #controlPanel label {
        display: block;
        margin: 6px 0;
        font-size: 11px;
        color: #d6d6d6;
      }

      #controlPanel input[type="checkbox"] {
        margin-right: 6px;
      }

      #controlPanel input[type="range"],
      #controlPanel select {
        width: 100%;
        margin-top: 4px;
      }

      #toggleControlPanel,
      #closeControlPanel {
        cursor: pointer;
      }

      #closeControlPanel {
        position: absolute;
        top: 12px;
        right: 12px;
        width: 28px;
        height: 28px;
        border-radius: 6px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(0, 0, 0, 0.5);
        color: #eee;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s;
      }

      #closeControlPanel:hover {
        background: rgba(255, 255, 255, 0.08);
      }

      .control-note {
        font-size: 10px;
        color: #8f9ab5;
        margin-bottom: 10px;
      }

      .control-divider {
        margin: 14px 0;
        border: 0;
        border-top: 1px solid rgba(255, 255, 255, 0.08);
      }

      .section-card {
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.04);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        margin-bottom: 12px;
      }

      #driverMetrics {
        display: none;
        margin-top: 8px;
        font-size: 10px;
        background: rgba(20, 20, 20, 0.7);
        padding: 8px;
        border: 1px solid #333;
        border-radius: 6px;
      }

      #driverMetrics table {
        width: 100%;
        border-collapse: collapse;
      }

      #driverMetrics td {
        padding: 3px 0;
      }

      @media (max-width: 1024px) {
        body {
          overflow: auto;
          padding-top: calc(var(--top-bar-height) + 4px);
        }

        #topBar {
          gap: 10px;
        }

        #topBar .top-actions {
          width: 100%;
          justify-content: space-between;
        }

        #canvasContainer {
          position: relative;
          top: calc(var(--top-bar-height) + var(--metrics-height));
          height: calc(60vh);
        }

        #controlPanel {
          left: 0;
          right: 0;
          top: auto;
          bottom: 12px;
          width: calc(100% - 32px);
          margin: 0 auto;
          max-height: min(65vh, 520px);
          transform: translateY(110%);
        }

        body.controls-open #controlPanel {
          transform: translateY(0);
        }
      }

      body.high-contrast {
        background: #000;
        color: #fff;
      }

      body.high-contrast #controlPanel,
      body.high-contrast #topBar,
      body.high-contrast .metrics-panel {
        background: #020202;
        border-color: #555;
      }

      body.no-motion *,
      body.no-motion #controlPanel,
      body.no-motion .metrics-panel {
        transition: none !important;
        animation: none !important;
      }
    </style>
      <script src="simple_test_shader.js"></script>
    <script src="force_visible.js"></script>
    <script src="progressive_shader_fix.js"></script>
</head>
  <body>
    <header id="topBar">
      <div class="brand">
        <strong>FIRM UI</strong>
        <span id="viewDescription">Clifford Field (Spacetime)</span>
      </div>
      <div class="top-actions">
        <label for="viewSelector" class="sr-only">Visualization view</label>
        <select id="viewSelector">
          <option value="clifford" selected>Clifford Field (Spacetime)</option>
          <option value="zx">ZX Graph (Quantum)</option>
          <option value="e8">E8 Topology (Œ±=1/137)</option>
          <option value="consciousness">Consciousness</option>
          <option value="sheaf">Sheaf Tree</option>
          <option value="echo">Echo Map</option>
        </select>
        <button id="toggleControlPanel" class="top-btn" type="button">‚öôÔ∏è Controls</button>
        <button id="topMetricsToggle" class="top-btn" type="button" aria-expanded="false">üìä Show Metrics</button>
        <button id="openInterpretation" class="top-btn interpretation-btn" type="button">üî¨ Physics Guide</button>
        <button id="topAutoAlignOmega" class="top-btn" type="button" title="One-shot alignment to Œ©">Œ© Align</button>
        <button id="topAutoOmegaMode" class="top-btn" type="button" title="Toggle continuous Œ© steering">Œ© Mode</button>
      </div>
    </header>

    <section id="metricsPanel" class="metrics-panel collapsed" aria-label="Scientific metrics">
      <div class="metrics-header" role="button" tabindex="0">
        <span class="metrics-title">üìä Scientific Metrics</span>
      </div>
      <div id="metricsContent" class="metrics-content" aria-hidden="true">
        <div class="metrics-grid">
          <div class="metric-group">
            <h4>ZX Graph Structure</h4>
            <div class="metric-row"><span class="metric-label">Nodes:</span><span id="metric-nodes">-</span></div>
            <div class="metric-row"><span class="metric-label">Z-spiders:</span><span id="metric-z-spiders">-</span></div>
            <div class="metric-row"><span class="metric-label">X-spiders:</span><span id="metric-x-spiders">-</span></div>
            <div class="metric-row"><span class="metric-label">Edges:</span><span id="metric-edges">-</span></div>
            <div class="metric-row"><span class="metric-label">Coherence C(G):</span><span id="metric-coherence">-</span></div>
          </div>
          <div class="metric-group">
            <h4>Clifford Field (Cl(1,3))</h4>
            <div class="metric-row"><span class="metric-label">Scalar (grade-0):</span><span id="metric-scalar">-</span></div>
            <div class="metric-row"><span class="metric-label">Vectors (grade-1):</span><span id="metric-vectors">-</span></div>
            <div class="metric-row"><span class="metric-label">Bivectors (grade-2):</span><span id="metric-bivectors">-</span></div>
            <div class="metric-row"><span class="metric-label">Trivectors (grade-3):</span><span id="metric-trivectors">-</span></div>
            <div class="metric-row"><span class="metric-label">Pseudoscalar:</span><span id="metric-pseudo">-</span></div>
          </div>
          <div class="metric-group">
            <h4>Evolution Dynamics</h4>
            <div class="metric-row"><span class="metric-label">Total rewrites:</span><span id="metric-rewrites">-</span></div>
            <div class="metric-row"><span class="metric-label">Fusion events:</span><span id="metric-fusion">-</span></div>
            <div class="metric-row"><span class="metric-label">Color-flips:</span><span id="metric-colorflip">-</span></div>
            <div class="metric-row"><span class="metric-label">Grace emergence:</span><span id="metric-grace">-</span></div>
            <div class="metric-row"><span class="metric-label">Evolution steps:</span><span id="metric-steps">-</span></div>
          </div>
          <div class="metric-group">
            <h4>Physics Observables</h4>
            <div class="metric-row"><span class="metric-label">Predicted spheres:</span><span id="metric-pred-spheres">-</span></div>
            <div class="metric-row"><span class="metric-label">Dominant grade:</span><span id="metric-dom-grade">-</span></div>
            <div class="metric-row"><span class="metric-label">Audio coherence Œ±:</span><span id="metric-audio">-</span></div>
            <div class="metric-row"><span class="metric-label">Bootstrap energy:</span><span id="metric-boot-energy">-</span></div>
            <div class="metric-row"><span class="metric-label">Emergence rate:</span><span id="metric-emerg-rate">-</span></div>
            <div class="metric-row"><span class="metric-label">Resonance Res(S,Œ©):</span><span id="metric-resonance">-</span></div>
          </div>
        </div>
      </div>
    </section>

    <main id="canvasContainer">
      <canvas id="canvas"></canvas>
    </main>

    <aside id="controlPanel" aria-label="Theory controls">
      <button id="closeControlPanel" type="button" aria-label="Close controls">‚úï</button>
      <p class="control-note">Use the controls below to adjust observation parameters, sacred seeding and waveform drivers. Metrics update in real time.</p>

      <div class="section-card">
        <h3>Accessibility</h3>
        <label><input type="checkbox" id="noMotion" /> Reduce motion</label>
        <label><input type="checkbox" id="highContrast" /> High contrast</label>
        <button id="enableAudio" style="margin-top: 10px; padding: 6px 10px; border-radius: 6px; border: 1px solid #2a2a2a; background: #151515; color: #eaeaea; cursor: pointer; width: 100%;">Enable Audio</button>
      </div>

      <div class="section-card">
        <h3>Theory Exploration</h3>
        <label>Grace Coherence œÜ: <span id="graceValue">1.618</span>
          <input type="range" id="graceSlider" min="1.0" max="2.5" step="0.001" value="1.618">
        </label>
        <label>Bootstrap Energy: <span id="bootstrapValue">1.0</span>
          <input type="range" id="bootstrapSlider" min="0.1" max="5.0" step="0.01" value="1.0">
        </label>
        <label>Emergence Rate: <span id="emergenceValue">1.0</span>
          <input type="range" id="emergenceSlider" min="0.1" max="3.0" step="0.01" value="1.0">
        </label>
        <label>Observation Distance: <span id="distanceValue">Auto</span>
          <input type="range" id="distanceSlider" min="1" max="50" step="0.1" value="25">
        </label>
        <label>Camera Vantage Point
          <select id="vantageSelector">
            <option value="auto">Auto (Emergent)</option>
            <option value="void_observer">Void Observer (Outer Shell)</option>
            <option value="phi_grace_torus">œÜ-Grace Torus</option>
            <option value="bootstrap_loop">Bootstrap Loop (Bell Chain)</option>
            <option value="sacred_axis">Sacred Axis (Aleph Flow)</option>
            <option value="coherence_shockfront">Coherence Shockfront</option>
            <optgroup label="Physics Perspectives">
              <option value="scalar_field">Scalar Field (Mass/Higgs)</option>
              <option value="vector_field">Vector Field (E-Field/Momentum)</option>
              <option value="bivector_field">Bivector Field (B-Field/Angular Momentum)</option>
              <option value="qft_perspective">QFT Perspective (Quantum Fields)</option>
              <option value="gr_perspective">GR Perspective (Spacetime Curvature)</option>
              <option value="qm_perspective">QM Perspective (Wave Functions)</option>
              <option value="lattice_gauge">Lattice Gauge Theory</option>
              <option value="emergence_view">Emergence View (Bootstrap Phases)</option>
              <option value="interference_view">Interference View (Standing Waves)</option>
              <option value="topology_view">Topology View (Manifold Structure)</option>
            </optgroup>
            <option value="custom">Custom (Preserve manual)</option>
          </select>
        </label>
        <button id="resetEvolution" style="margin-top: 10px; padding: 6px 10px; width: 100%; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Reset to Void</button>
        <button id="autoAlignOmega" style="margin-top: 8px; padding: 6px 10px; width: 100%; border-radius: 6px; border: 1px solid #2a2a2a; background: #143b1a; color: #eaeaea; cursor: pointer;">Auto Align to Œ©</button>
        <button id="autoOmegaModeToggle" style="margin-top: 8px; padding: 6px 10px; width: 100%; border-radius: 6px; border: 1px solid #2a2a2a; background: #1a233b; color: #eaeaea; cursor: pointer;">Enable Auto Œ© Mode</button>
      </div>

      <div class="section-card">
        <h3>Consciousness View</h3>
        <label><input type="checkbox" id="showConsciousness" checked> Show Consciousness Levels</label>
        <label><input type="checkbox" id="showWill" checked> Show Will to Emerge</label>
        <label><input type="checkbox" id="showReflexivePain" checked> Show Reflexive Pain</label>
        <label><input type="checkbox" id="showOrMakifPnimi"> Show Or Makif/Pnimi Bridge</label>
      </div>

      <div class="section-card">
        <h3>Sacred Morphic Seeds</h3>
        <label>Sacred Name Index: <span id="sacredNameValue">0</span>
          <input type="range" id="sacredNameSlider" min="0" max="71" step="1" value="0">
        </label>
        <button id="seedSacredName" style="margin-top: 8px; padding: 6px 10px; width: 100%; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Seed with Sacred Name</button>
        <label style="margin-top: 10px;">Hebrew Boundary Letter
          <select id="hebrewBoundary">
            <option value="">None</option>
            <option value="◊ê">◊ê (Aleph - Unity)</option>
            <option value="◊ë">◊ë (Bet - House)</option>
            <option value="◊í">◊í (Gimel - Flow)</option>
            <option value="◊ì">◊ì (Dalet - Door)</option>
            <option value="◊î">◊î (Heh - Breath)</option>
            <option value="◊ï">◊ï (Vav - Connection)</option>
            <option value="◊ô">◊ô (Yod - Divine Spark)</option>
            <option value="◊õ">◊õ (Chaf - Palm)</option>
            <option value="◊ú">◊ú (Lamed - Teaching)</option>
            <option value="◊û">◊û (Mem - Water)</option>
            <option value="◊†">◊† (Nun - Fish/Soul)</option>
            <option value="◊§">◊§ (Peh - Mouth)</option>
            <option value="◊®">◊® (Resh - Head)</option>
            <option value="◊©">◊© (Shin - Fire)</option>
            <option value="◊™">◊™ (Tav - Foundation)</option>
          </select>
        </label>
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <button id="applySacredBoundary" style="flex: 1; padding: 6px 10px; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Apply Boundary</button>
          <button id="getSacredCommentary" style="flex: 1; padding: 6px 10px; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Commentary</button>
        </div>
      </div>

      <div class="section-card">
        <h3>Waveform Drivers</h3>
        <label>Driver Type
          <select id="waveformDriver">
            <option value="sine">Sine (Default)</option>
            <option value="fractal">Fractal (1/f)</option>
            <option value="phi_recursive">œÜ-Recursive</option>
            <option value="hebrew_letter">Hebrew Letter</option>
            <option value="sacred_name">Sacred Name</option>
            <option value="quantum">Quantum Coherence</option>
            <option value="morphic">Morphic Resonance</option>
          </select>
        </label>
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <button id="switchWaveformDriver" style="flex: 1; padding: 6px 10px; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Switch Driver</button>
          <button id="testDriverEffects" style="flex: 1; padding: 6px 10px; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Test Effects</button>
        </div>
        <button id="stopDriverTest" style="margin-top: 8px; padding: 6px 10px; width: 100%; border-radius: 6px; border: 1px solid #2a2a2a; background: #191919; color: #eaeaea; cursor: pointer;">Stop Test</button>
        <div id="driverMetrics">
          <div style="font-size: 11px; color: #ccc; margin-bottom: 4px;">üìä Driver Analysis <span id="driverMetricsStatus" style="color: #888;">Idle</span></div>
          <table>
            <tbody id="driverMetricsBody"></tbody>
          </table>
        </div>
      </div>
    </aside>

    <script src="theory_logger.js?v=2025-10-04-1"></script>
    <script type="module" src="main.js?v=2025-10-04-1"></script>
    <script src="emergency_fix.js?v=2025-10-04-1"></script>
    <script src="visual_debug.js?v=2025-10-04-1"></script>
    <script src="camera_external_fix.js?v=2025-10-04-1"></script>
    <script src="geometry_diagnostics.js?v=2025-10-04-1"></script>
    <script type="module" src="interpretation_modal.js?v=2025-10-04-1"></script>
    <script src="metrics_updater.js?v=2025-10-04-1"></script>
    <script type="module" src="sacred_morphic_seeds.js?v=2025-10-04-1"></script>
    <script type="module" src="sacred_direct_injection.js?v=2025-10-04-1"></script>
    <script type="module" src="fractal_waveform_drivers.js?v=2025-10-04-1"></script>
    <script type="module" src="theory_validation_tests.js?v=2025-10-04-1"></script>
    <script type="module">import * as __res from './FIRM_dsl/resonance.js?v=2025-10-04-1'; window.__resonanceMod = __res;</script>
    <!-- Vercel Web Analytics & Speed Insights for static sites -->
    <script defer src="/_vercel/insights/script.js"></script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
  </body>
</html>
